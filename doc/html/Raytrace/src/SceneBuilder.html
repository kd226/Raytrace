<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : SceneBuilder
Description : Building 'World' to render
Copyright   : (c) Konrad Dobro&#347;, 2017
License     : GPL-3
Maintainer  : dobros.konrad@gmail.com
Stability   : experimental
Portability : POSIX

This module contains functions used to build and manipulate everything that
is to be rendered. They should be used in state monad as with modify function,
however in case of different need they are defined as pure modifiers.
-}</span><span>
</span><a name="line-14"></a><span>
</span><a name="line-15"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">SceneBuilder</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-16"></a><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span> </span><a href="Types.html"><span class="hs-identifier">Types</span></a><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span> </span><a href="Predefined.html"><span class="hs-identifier">Predefined</span></a><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">State</span><span class="hs-operator">.</span><span class="hs-identifier">Strict</span><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Vect</span><span class="hs-operator">.</span><span class="hs-identifier">Double</span><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Debug</span><span class="hs-operator">.</span><span class="hs-identifier">Trace</span><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Random</span><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span class="hs-comment">-- | Just an empty scene without any objects, with 'grey' ambient light and 'black' background.</span><span>
</span><a name="line-25"></a><span class="hs-identifier">emptyScene</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Types.html#Scene"><span class="hs-identifier hs-type">Scene</span></a><span>
</span><a name="line-26"></a><a name="emptyScene"><a href="SceneBuilder.html#emptyScene"><span class="hs-identifier">emptyScene</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Types.html#Scene"><span class="hs-identifier hs-var">Scene</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="Predefined.html#grey"><span class="hs-identifier hs-var">grey</span></a><span> </span><a href="Predefined.html#black"><span class="hs-identifier hs-var">black</span></a><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span class="hs-comment">-- | Adds shape to a scene</span><span>
</span><a name="line-29"></a><span class="hs-identifier">addShape</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Types.html#Shape"><span class="hs-identifier hs-type">Shape</span></a><span> </span><span class="hs-comment">-- ^ Shape that has to be added</span><span>
</span><a name="line-30"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Types.html#Scene"><span class="hs-identifier hs-type">Scene</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Types.html#Scene"><span class="hs-identifier hs-type">Scene</span></a><span>
</span><a name="line-31"></a><a name="addShape"><a href="SceneBuilder.html#addShape"><span class="hs-identifier">addShape</span></a></a><span> </span><a name="local-1627419071"><a href="#local-1627419071"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-1627419072"><a href="#local-1627419072"><span class="hs-identifier">sc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Types.html#Scene"><span class="hs-identifier hs-var">Scene</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627419071"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">shapes</span><span> </span><a href="#local-1627419072"><span class="hs-identifier hs-var">sc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">lights</span><span> </span><a href="#local-1627419072"><span class="hs-identifier hs-var">sc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ambientLight</span><span> </span><a href="#local-1627419072"><span class="hs-identifier hs-var">sc</span></a><span class="hs-special">)</span><span>
</span><a name="line-32"></a><span>                      </span><span class="hs-special">(</span><span class="hs-identifier">backgroundColor</span><span> </span><a href="#local-1627419072"><span class="hs-identifier hs-var">sc</span></a><span class="hs-special">)</span><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-comment">-- | Adds spherical light to a scene</span><span>
</span><a name="line-35"></a><span class="hs-identifier">addLight</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Types.html#Point3"><span class="hs-identifier hs-type">Point3</span></a><span> </span><span class="hs-comment">-- ^ Center of a light source</span><span>
</span><a name="line-36"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-comment">-- ^ Radius of a light sphere</span><span>
</span><a name="line-37"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Types.html#Color"><span class="hs-identifier hs-type">Color</span></a><span> </span><span class="hs-comment">-- ^ Color of a light</span><span>
</span><a name="line-38"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Types.html#Scene"><span class="hs-identifier hs-type">Scene</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Types.html#Scene"><span class="hs-identifier hs-type">Scene</span></a><span>
</span><a name="line-39"></a><a name="addLight"><a href="SceneBuilder.html#addLight"><span class="hs-identifier">addLight</span></a></a><span> </span><a name="local-1627419073"><a href="#local-1627419073"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-1627419074"><a href="#local-1627419074"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-1627419075"><a href="#local-1627419075"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-1627419076"><a href="#local-1627419076"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Types.html#Scene"><span class="hs-identifier hs-var">Scene</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627419077"><span class="hs-identifier hs-var">light</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">shapes</span><span> </span><a href="#local-1627419076"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1627419073"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">lights</span><span> </span><a href="#local-1627419076"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ambientLight</span><span> </span><a href="#local-1627419076"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-40"></a><span>           </span><span class="hs-special">(</span><span class="hs-identifier">backgroundColor</span><span> </span><a href="#local-1627419076"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-41"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-42"></a><span>    </span><a name="local-1627419077"><a href="#local-1627419077"><span class="hs-identifier">light</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Types.html#Sphere"><span class="hs-identifier hs-var">Sphere</span></a><span> </span><a href="#local-1627419073"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-1627419074"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">(</span><a href="Predefined.html#lightBulb"><span class="hs-identifier hs-var">lightBulb</span></a><span> </span><a href="#local-1627419075"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-43"></a><span>
</span><a name="line-44"></a><span class="hs-comment">-- | Changes ambient light in a scene</span><span>
</span><a name="line-45"></a><span class="hs-identifier">setAmbientLight</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Types.html#Color"><span class="hs-identifier hs-type">Color</span></a><span> </span><span class="hs-comment">-- ^ New ambient light</span><span>
</span><a name="line-46"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Types.html#Scene"><span class="hs-identifier hs-type">Scene</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Types.html#Scene"><span class="hs-identifier hs-type">Scene</span></a><span>
</span><a name="line-47"></a><a name="setAmbientLight"><a href="SceneBuilder.html#setAmbientLight"><span class="hs-identifier">setAmbientLight</span></a></a><span> </span><a name="local-1627419078"><a href="#local-1627419078"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-1627419079"><a href="#local-1627419079"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Types.html#Scene"><span class="hs-identifier hs-var">Scene</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">shapes</span><span> </span><a href="#local-1627419079"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">lights</span><span> </span><a href="#local-1627419079"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627419078"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">backgroundColor</span><span> </span><a href="#local-1627419079"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-48"></a><span>
</span><a name="line-49"></a><span class="hs-comment">-- | Changes background color of a scene</span><span>
</span><a name="line-50"></a><span class="hs-identifier">setBackgroundColor</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Types.html#Color"><span class="hs-identifier hs-type">Color</span></a><span> </span><span class="hs-comment">-- ^ New background color</span><span>
</span><a name="line-51"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Types.html#Scene"><span class="hs-identifier hs-type">Scene</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Types.html#Scene"><span class="hs-identifier hs-type">Scene</span></a><span>
</span><a name="line-52"></a><a name="setBackgroundColor"><a href="SceneBuilder.html#setBackgroundColor"><span class="hs-identifier">setBackgroundColor</span></a></a><span> </span><a name="local-1627419080"><a href="#local-1627419080"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-1627419081"><a href="#local-1627419081"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Types.html#Scene"><span class="hs-identifier hs-var">Scene</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">shapes</span><span> </span><a href="#local-1627419081"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">lights</span><span> </span><a href="#local-1627419081"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ambientLight</span><span> </span><a href="#local-1627419081"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627419080"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-comment">-- | Sample view with camera at (0,0,0), looking in (0,0,1) direction,</span><span>
</span><a name="line-55"></a><span class="hs-comment">--   oriented along y and with field of view equal 110</span><span>
</span><a name="line-56"></a><a name="sampleView"><a href="SceneBuilder.html#sampleView"><span class="hs-identifier">sampleView</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Types.html#View"><span class="hs-identifier hs-var">View</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vec3</span><span> </span><span class="hs-number">0.0</span><span> </span><span class="hs-number">0.0</span><span> </span><span class="hs-number">0.0</span><span class="hs-special">)</span><span> </span><span class="hs-number">0.01</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkNormal</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vec3</span><span> </span><span class="hs-number">0.0</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">0.0</span><span class="hs-special">)</span><span> </span><span class="hs-number">0.5</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-57"></a><span>                  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkNormal</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vec3</span><span> </span><span class="hs-number">0.0</span><span> </span><span class="hs-number">1.0</span><span> </span><span class="hs-number">0.0</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-number">11.0</span><span class="hs-operator hs-var">/</span><span class="hs-number">9.0</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-identifier hs-var">pi</span><span class="hs-operator hs-var">/</span><span class="hs-number">2</span><span class="hs-special">)</span><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><span class="hs-comment">-- | Yaws camera forward, that is rotates around vertical/right vector</span><span>
</span><a name="line-60"></a><span class="hs-identifier">yawCamera</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-comment">-- ^ Number of radians to rotate by</span><span>
</span><a name="line-61"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Types.html#View"><span class="hs-identifier hs-type">View</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Types.html#View"><span class="hs-identifier hs-type">View</span></a><span>
</span><a name="line-62"></a><a name="yawCamera"><a href="SceneBuilder.html#yawCamera"><span class="hs-identifier">yawCamera</span></a></a><span> </span><a name="local-1627419082"><a href="#local-1627419082"><span class="hs-identifier">phi</span></a></a><span> </span><a name="local-1627419083"><a href="#local-1627419083"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Types.html#View"><span class="hs-identifier hs-var">View</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">camera</span><span> </span><a href="#local-1627419083"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">clipPlane</span><span> </span><a href="#local-1627419083"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627419088"><span class="hs-identifier hs-var">newFor</span></a><span> </span><a href="#local-1627419087"><span class="hs-identifier hs-var">newUp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">fov</span><span> </span><a href="#local-1627419083"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-63"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-64"></a><span>    </span><a name="local-1627419084"><a href="#local-1627419084"><span class="hs-identifier">oldUp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">up</span><span> </span><a href="#local-1627419083"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-65"></a><span>    </span><a name="local-1627419085"><a href="#local-1627419085"><span class="hs-identifier">oldForward</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">forward</span><span> </span><a href="#local-1627419083"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-66"></a><span>    </span><a name="local-1627419086"><a href="#local-1627419086"><span class="hs-identifier">right</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627419085"><span class="hs-identifier hs-var">oldForward</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">crossprod</span><span class="hs-special">`</span><span> </span><a href="#local-1627419084"><span class="hs-identifier hs-var">oldUp</span></a><span>
</span><a name="line-67"></a><span>    </span><a name="local-1627419087"><a href="#local-1627419087"><span class="hs-identifier">newUp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkNormal</span><span class="hs-operator hs-var">$</span><span class="hs-identifier hs-var">rotate3'</span><span> </span><a href="#local-1627419082"><span class="hs-identifier hs-var">phi</span></a><span> </span><a href="#local-1627419086"><span class="hs-identifier hs-var">right</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromNormal</span><span> </span><a href="#local-1627419084"><span class="hs-identifier hs-var">oldUp</span></a><span class="hs-special">)</span><span>
</span><a name="line-68"></a><span>    </span><a name="local-1627419088"><a href="#local-1627419088"><span class="hs-identifier">newFor</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkNormal</span><span class="hs-operator hs-var">$</span><span class="hs-identifier hs-var">rotate3'</span><span> </span><a href="#local-1627419082"><span class="hs-identifier hs-var">phi</span></a><span> </span><a href="#local-1627419086"><span class="hs-identifier hs-var">right</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromNormal</span><span> </span><a href="#local-1627419085"><span class="hs-identifier hs-var">oldForward</span></a><span class="hs-special">)</span><span>
</span><a name="line-69"></a><span class="hs-comment">-- | Moves camera to a new position</span><span>
</span><a name="line-70"></a><span class="hs-identifier">positionCamera</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Vec3</span><span> </span><span class="hs-comment">-- ^ New camera position</span><span>
</span><a name="line-71"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Types.html#View"><span class="hs-identifier hs-type">View</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Types.html#View"><span class="hs-identifier hs-type">View</span></a><span>
</span><a name="line-72"></a><a name="positionCamera"><a href="SceneBuilder.html#positionCamera"><span class="hs-identifier">positionCamera</span></a></a><span> </span><a name="local-1627419118"><a href="#local-1627419118"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-1627419119"><a href="#local-1627419119"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Types.html#View"><span class="hs-identifier hs-var">View</span></a><span> </span><a href="#local-1627419118"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">clipPlane</span><span> </span><a href="#local-1627419119"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">forward</span><span> </span><a href="#local-1627419119"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">up</span><span> </span><a href="#local-1627419119"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fov</span><span> </span><a href="#local-1627419119"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span class="hs-comment">-- | Sample 'World' with 'emptyScene' and 'sampleView' with ray depth of 10,</span><span>
</span><a name="line-75"></a><span class="hs-comment">-- 1 frame to render and resolution of 500x500</span><span>
</span><a name="line-76"></a><span class="hs-identifier">sampleWorld</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Types.html#World"><span class="hs-identifier hs-type">World</span></a><span>
</span><a name="line-77"></a><a name="sampleWorld"><a href="SceneBuilder.html#sampleWorld"><span class="hs-identifier">sampleWorld</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Types.html#World"><span class="hs-identifier hs-var">World</span></a><span> </span><a href="SceneBuilder.html#emptyScene"><span class="hs-identifier hs-var">emptyScene</span></a><span> </span><a href="SceneBuilder.html#sampleView"><span class="hs-identifier hs-var">sampleView</span></a><span> </span><span class="hs-number">10</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">500</span><span> </span><span class="hs-number">500</span><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span class="hs-comment">-- | Save 'Scene' to a 'World'</span><span>
</span><a name="line-80"></a><span class="hs-identifier">setScene</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Types.html#Scene"><span class="hs-identifier hs-type">Scene</span></a><span> </span><span class="hs-comment">-- ^ 'Scene' to save</span><span>
</span><a name="line-81"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Types.html#World"><span class="hs-identifier hs-type">World</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Types.html#World"><span class="hs-identifier hs-type">World</span></a><span>
</span><a name="line-82"></a><a name="setScene"><a href="SceneBuilder.html#setScene"><span class="hs-identifier">setScene</span></a></a><span> </span><a name="local-1627419120"><a href="#local-1627419120"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Types.html#World"><span class="hs-identifier hs-var">World</span></a><span> </span><a name="local-1627419121"><a href="#local-1627419121"><span class="hs-identifier">sc</span></a></a><span> </span><a name="local-1627419122"><a href="#local-1627419122"><span class="hs-identifier">vi</span></a></a><span> </span><a name="local-1627419123"><a href="#local-1627419123"><span class="hs-identifier">rd</span></a></a><span> </span><a name="local-1627419124"><a href="#local-1627419124"><span class="hs-identifier">samp</span></a></a><span> </span><a name="local-1627419125"><a href="#local-1627419125"><span class="hs-identifier">width</span></a></a><span> </span><a name="local-1627419126"><a href="#local-1627419126"><span class="hs-identifier">height</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Types.html#World"><span class="hs-identifier hs-var">World</span></a><span> </span><a href="#local-1627419120"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-1627419122"><span class="hs-identifier hs-var">vi</span></a><span> </span><a href="#local-1627419123"><span class="hs-identifier hs-var">rd</span></a><span> </span><a href="#local-1627419124"><span class="hs-identifier hs-var">samp</span></a><span> </span><a href="#local-1627419125"><span class="hs-identifier hs-var">width</span></a><span> </span><a href="#local-1627419126"><span class="hs-identifier hs-var">height</span></a><span>
</span><a name="line-83"></a><span class="hs-comment">-- | Save 'View' to a 'World'</span><span>
</span><a name="line-84"></a><span class="hs-identifier">setView</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Types.html#View"><span class="hs-identifier hs-type">View</span></a><span>  </span><span class="hs-comment">-- ^ New 'View' to save</span><span>
</span><a name="line-85"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Types.html#World"><span class="hs-identifier hs-type">World</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Types.html#World"><span class="hs-identifier hs-type">World</span></a><span>
</span><a name="line-86"></a><a name="setView"><a href="SceneBuilder.html#setView"><span class="hs-identifier">setView</span></a></a><span> </span><a name="local-1627419127"><a href="#local-1627419127"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-special">(</span><a href="Types.html#World"><span class="hs-identifier hs-var">World</span></a><span> </span><a name="local-1627419128"><a href="#local-1627419128"><span class="hs-identifier">sc</span></a></a><span> </span><a name="local-1627419129"><a href="#local-1627419129"><span class="hs-identifier">vi</span></a></a><span> </span><a name="local-1627419130"><a href="#local-1627419130"><span class="hs-identifier">rd</span></a></a><span> </span><a name="local-1627419131"><a href="#local-1627419131"><span class="hs-identifier">samp</span></a></a><span> </span><a name="local-1627419132"><a href="#local-1627419132"><span class="hs-identifier">width</span></a></a><span> </span><a name="local-1627419133"><a href="#local-1627419133"><span class="hs-identifier">height</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Types.html#World"><span class="hs-identifier hs-var">World</span></a><span> </span><a href="#local-1627419128"><span class="hs-identifier hs-var">sc</span></a><span> </span><a href="#local-1627419127"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-1627419130"><span class="hs-identifier hs-var">rd</span></a><span> </span><a href="#local-1627419131"><span class="hs-identifier hs-var">samp</span></a><span> </span><a href="#local-1627419132"><span class="hs-identifier hs-var">width</span></a><span> </span><a href="#local-1627419133"><span class="hs-identifier hs-var">height</span></a><span>
</span><a name="line-87"></a><span class="hs-comment">-- | Set depth of rays in a 'World'</span><span>
</span><a name="line-88"></a><span class="hs-identifier">setRayDepth</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^ New depth of rays</span><span>
</span><a name="line-89"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Types.html#World"><span class="hs-identifier hs-type">World</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Types.html#World"><span class="hs-identifier hs-type">World</span></a><span>
</span><a name="line-90"></a><a name="setRayDepth"><a href="SceneBuilder.html#setRayDepth"><span class="hs-identifier">setRayDepth</span></a></a><span> </span><a name="local-1627419134"><a href="#local-1627419134"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-special">(</span><a href="Types.html#World"><span class="hs-identifier hs-var">World</span></a><span> </span><a name="local-1627419135"><a href="#local-1627419135"><span class="hs-identifier">sc</span></a></a><span> </span><a name="local-1627419136"><a href="#local-1627419136"><span class="hs-identifier">vi</span></a></a><span> </span><a name="local-1627419137"><a href="#local-1627419137"><span class="hs-identifier">rd</span></a></a><span> </span><a name="local-1627419138"><a href="#local-1627419138"><span class="hs-identifier">samp</span></a></a><span> </span><a name="local-1627419139"><a href="#local-1627419139"><span class="hs-identifier">width</span></a></a><span> </span><a name="local-1627419140"><a href="#local-1627419140"><span class="hs-identifier">height</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Types.html#World"><span class="hs-identifier hs-var">World</span></a><span> </span><a href="#local-1627419135"><span class="hs-identifier hs-var">sc</span></a><span> </span><a href="#local-1627419136"><span class="hs-identifier hs-var">vi</span></a><span> </span><a href="#local-1627419134"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-1627419138"><span class="hs-identifier hs-var">samp</span></a><span> </span><a href="#local-1627419139"><span class="hs-identifier hs-var">width</span></a><span> </span><a href="#local-1627419140"><span class="hs-identifier hs-var">height</span></a><span>
</span><a name="line-91"></a><span class="hs-comment">-- | Set number of samples to average when rendering this 'World'</span><span>
</span><a name="line-92"></a><span class="hs-identifier">setSamples</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^ Number of samples</span><span>
</span><a name="line-93"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Types.html#World"><span class="hs-identifier hs-type">World</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Types.html#World"><span class="hs-identifier hs-type">World</span></a><span>
</span><a name="line-94"></a><a name="setSamples"><a href="SceneBuilder.html#setSamples"><span class="hs-identifier">setSamples</span></a></a><span> </span><a name="local-1627419141"><a href="#local-1627419141"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Types.html#World"><span class="hs-identifier hs-var">World</span></a><span> </span><a name="local-1627419142"><a href="#local-1627419142"><span class="hs-identifier">sc</span></a></a><span> </span><a name="local-1627419143"><a href="#local-1627419143"><span class="hs-identifier">vi</span></a></a><span> </span><a name="local-1627419144"><a href="#local-1627419144"><span class="hs-identifier">rd</span></a></a><span> </span><a name="local-1627419145"><a href="#local-1627419145"><span class="hs-identifier">samp</span></a></a><span> </span><a name="local-1627419146"><a href="#local-1627419146"><span class="hs-identifier">width</span></a></a><span> </span><a name="local-1627419147"><a href="#local-1627419147"><span class="hs-identifier">height</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Types.html#World"><span class="hs-identifier hs-var">World</span></a><span> </span><a href="#local-1627419142"><span class="hs-identifier hs-var">sc</span></a><span> </span><a href="#local-1627419143"><span class="hs-identifier hs-var">vi</span></a><span> </span><a href="#local-1627419144"><span class="hs-identifier hs-var">rd</span></a><span> </span><a href="#local-1627419141"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-1627419146"><span class="hs-identifier hs-var">width</span></a><span> </span><a href="#local-1627419147"><span class="hs-identifier hs-var">height</span></a><span>
</span><a name="line-95"></a><span class="hs-comment">-- | Set width of rendered image</span><span>
</span><a name="line-96"></a><span class="hs-identifier">setWidth</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Types.html#World"><span class="hs-identifier hs-type">World</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Types.html#World"><span class="hs-identifier hs-type">World</span></a><span>
</span><a name="line-97"></a><a name="setWidth"><a href="SceneBuilder.html#setWidth"><span class="hs-identifier">setWidth</span></a></a><span> </span><a name="local-1627419148"><a href="#local-1627419148"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-special">(</span><a href="Types.html#World"><span class="hs-identifier hs-var">World</span></a><span> </span><a name="local-1627419149"><a href="#local-1627419149"><span class="hs-identifier">sc</span></a></a><span> </span><a name="local-1627419150"><a href="#local-1627419150"><span class="hs-identifier">vi</span></a></a><span> </span><a name="local-1627419151"><a href="#local-1627419151"><span class="hs-identifier">rd</span></a></a><span> </span><a name="local-1627419152"><a href="#local-1627419152"><span class="hs-identifier">samp</span></a></a><span> </span><a name="local-1627419153"><a href="#local-1627419153"><span class="hs-identifier">width</span></a></a><span> </span><a name="local-1627419154"><a href="#local-1627419154"><span class="hs-identifier">height</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Types.html#World"><span class="hs-identifier hs-var">World</span></a><span> </span><a href="#local-1627419149"><span class="hs-identifier hs-var">sc</span></a><span> </span><a href="#local-1627419150"><span class="hs-identifier hs-var">vi</span></a><span> </span><a href="#local-1627419151"><span class="hs-identifier hs-var">rd</span></a><span> </span><a href="#local-1627419152"><span class="hs-identifier hs-var">samp</span></a><span> </span><a href="#local-1627419148"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-1627419154"><span class="hs-identifier hs-var">height</span></a><span>
</span><a name="line-98"></a><span class="hs-comment">-- | Set height of rendered image</span><span>
</span><a name="line-99"></a><span class="hs-identifier">setHeight</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Types.html#World"><span class="hs-identifier hs-type">World</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Types.html#World"><span class="hs-identifier hs-type">World</span></a><span>
</span><a name="line-100"></a><a name="setHeight"><a href="SceneBuilder.html#setHeight"><span class="hs-identifier">setHeight</span></a></a><span> </span><a name="local-1627419155"><a href="#local-1627419155"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-special">(</span><a href="Types.html#World"><span class="hs-identifier hs-var">World</span></a><span> </span><a name="local-1627419156"><a href="#local-1627419156"><span class="hs-identifier">sc</span></a></a><span> </span><a name="local-1627419157"><a href="#local-1627419157"><span class="hs-identifier">vi</span></a></a><span> </span><a name="local-1627419158"><a href="#local-1627419158"><span class="hs-identifier">rd</span></a></a><span> </span><a name="local-1627419159"><a href="#local-1627419159"><span class="hs-identifier">samp</span></a></a><span> </span><a name="local-1627419160"><a href="#local-1627419160"><span class="hs-identifier">width</span></a></a><span> </span><a name="local-1627419161"><a href="#local-1627419161"><span class="hs-identifier">height</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Types.html#World"><span class="hs-identifier hs-var">World</span></a><span> </span><a href="#local-1627419156"><span class="hs-identifier hs-var">sc</span></a><span> </span><a href="#local-1627419157"><span class="hs-identifier hs-var">vi</span></a><span> </span><a href="#local-1627419158"><span class="hs-identifier hs-var">rd</span></a><span> </span><a href="#local-1627419159"><span class="hs-identifier hs-var">samp</span></a><span> </span><a href="#local-1627419160"><span class="hs-identifier hs-var">width</span></a><span> </span><a href="#local-1627419155"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-101"></a></pre></body></html>